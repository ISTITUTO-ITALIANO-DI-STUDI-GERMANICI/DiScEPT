{"ast":null,"code":"import*as React from\"react\";import Dialog from\"@mui/material/Dialog\";import DialogActions from\"@mui/material/DialogActions\";import DialogContent from\"@mui/material/DialogContent\";import DialogContentText from\"@mui/material/DialogContentText\";import DialogTitle from\"@mui/material/DialogTitle\";import Button from\"@mui/material/Button\";import TextField from\"@mui/material/TextField\";import data from\"../Data.js\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function DisceptFileUploader(_ref){let{fileUploaded,onChange}=_ref;const[file,setFile]=React.useState(null);const[overwriteDialogShown,setOverwriteDialogShown]=React.useState(false);const[genericErrorDialogShown,setGenericErrorDialogShown]=React.useState(false);const[noDisceptDialogShown,setNoDisceptDialogShown]=React.useState(false);const[loadCompletedDialogShown,setLoadCompletedDialogShown]=React.useState(false);const[addingLanguage,setAddingLanguage]=React.useState(\"\");function fileLoaded(){setLoadCompletedDialogShown(true);}function closeLoadCompletedDialog(){setLoadCompletedDialogShown(false);onChange();}function readFile(file){data.readFromFile(file).then(fileLoaded,catchError);}if(file!==fileUploaded){setFile(fileUploaded);if(data.isChanged){setOverwriteDialogShown(data.isChanged);// We will continue when the dialog is dismised.\n}else{readFile(fileUploaded);}}function closeOverwriteDialog(){setOverwriteDialogShown(false);}function overwriteFile(){closeOverwriteDialog();readFile(file);}function catchError(err){switch(err.message){case\"no-discept\":setNoDisceptDialogShown(true);break;case\"invalid\":default:setGenericErrorDialogShown(true);break;}}function closeGenericErrorDialog(){setGenericErrorDialogShown(false);}function closeNoDisceptDialog(){setNoDisceptDialogShown(false);}function addLanguage(){closeNoDisceptDialog();data.addFileDocumentPerLanguage(addingLanguage,file);onChange();}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Dialog,{open:loadCompletedDialogShown,onClose:closeLoadCompletedDialog,\"aria-labelledby\":\"loadCompleted-dialog\",\"aria-describedby\":\"loadCompleted-dialog-desc\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"loadCompleted-dialog\",children:\"Data imported!\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{id:\"loadCompleted-dialog-desc\",children:\"The file has been correctly imported!\"})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:closeLoadCompletedDialog,children:\"OK\"})})]}),/*#__PURE__*/_jsxs(Dialog,{open:overwriteDialogShown,onClose:closeOverwriteDialog,\"aria-labelledby\":\"overwrite-dialog\",\"aria-describedby\":\"overwrite-dialog-desc\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"overwrite-dialog\",children:\"Changes will be overwritten!\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{id:\"overwrite-dialog-desc\",children:\"Please confirm you want to upload this new file and overwrite the existing changes\"})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:closeOverwriteDialog,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:overwriteFile,autoFocus:true,children:\"Continue\"})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:genericErrorDialogShown,onClose:closeGenericErrorDialog,\"aria-labelledby\":\"generic-error-dialog\",\"aria-describedby\":\"generic-error-dialog-desc\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"generic-error-dialog\",children:\"Something wrong happened!\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{id:\"generic-error-dialog-desc\",children:\"The uploaded file cannot be read correctly\"})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:closeGenericErrorDialog,children:\"OK\"})})]}),/*#__PURE__*/_jsxs(Dialog,{open:noDisceptDialogShown,onClose:closeNoDisceptDialog,\"aria-labelledby\":\"no-discept\",\"aria-describedby\":\"no-discept-desc\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"no-discept\",children:\"Valid TEI But...\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(DialogContentText,{id:\"no-discept-desc\",children:\"The uploaded file does not look like a DiSCePT TEI model. Do you want to import it as a language instead?\"}),/*#__PURE__*/_jsx(TextField,{autoFocus:true,required:true,margin:\"dense\",id:\"language\",name:\"language\",label:\"Language\",type:\"text\",fullWidth:true,variant:\"standard\",onChange:e=>setAddingLanguage(e.target.value)})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:closeNoDisceptDialog,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:addLanguage,autoFocus:true,children:\"Add\"})]})]})]});}","map":{"version":3,"names":["React","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Button","TextField","data","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DisceptFileUploader","_ref","fileUploaded","onChange","file","setFile","useState","overwriteDialogShown","setOverwriteDialogShown","genericErrorDialogShown","setGenericErrorDialogShown","noDisceptDialogShown","setNoDisceptDialogShown","loadCompletedDialogShown","setLoadCompletedDialogShown","addingLanguage","setAddingLanguage","fileLoaded","closeLoadCompletedDialog","readFile","readFromFile","then","catchError","isChanged","closeOverwriteDialog","overwriteFile","err","message","closeGenericErrorDialog","closeNoDisceptDialog","addLanguage","addFileDocumentPerLanguage","children","open","onClose","id","onClick","autoFocus","required","margin","name","label","type","fullWidth","variant","e","target","value"],"sources":["/home/runner/work/DiScEPT/DiScEPT/src/components/fileuploader.js"],"sourcesContent":["import * as React from \"react\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogContentText from \"@mui/material/DialogContentText\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport Button from \"@mui/material/Button\";\nimport TextField from \"@mui/material/TextField\";\n\nimport data from \"../Data.js\";\n\nexport default function DisceptFileUploader({ fileUploaded, onChange }) {\n  const [file, setFile] = React.useState(null);\n  const [overwriteDialogShown, setOverwriteDialogShown] = React.useState(false);\n  const [genericErrorDialogShown, setGenericErrorDialogShown] =\n    React.useState(false);\n  const [noDisceptDialogShown, setNoDisceptDialogShown] = React.useState(false);\n  const [loadCompletedDialogShown, setLoadCompletedDialogShown] =\n    React.useState(false);\n  const [addingLanguage, setAddingLanguage] = React.useState(\"\");\n\n  function fileLoaded() {\n    setLoadCompletedDialogShown(true);\n  }\n\n  function closeLoadCompletedDialog() {\n    setLoadCompletedDialogShown(false);\n    onChange();\n  }\n\n  function readFile(file) {\n    data.readFromFile(file).then(fileLoaded, catchError);\n  }\n\n  if (file !== fileUploaded) {\n    setFile(fileUploaded);\n\n    if (data.isChanged) {\n      setOverwriteDialogShown(data.isChanged);\n      // We will continue when the dialog is dismised.\n    } else {\n      readFile(fileUploaded);\n    }\n  }\n\n  function closeOverwriteDialog() {\n    setOverwriteDialogShown(false);\n  }\n\n  function overwriteFile() {\n    closeOverwriteDialog();\n    readFile(file);\n  }\n\n  function catchError(err) {\n    switch (err.message) {\n      case \"no-discept\":\n        setNoDisceptDialogShown(true);\n        break;\n\n      case \"invalid\":\n      default:\n        setGenericErrorDialogShown(true);\n        break;\n    }\n  }\n\n  function closeGenericErrorDialog() {\n    setGenericErrorDialogShown(false);\n  }\n\n  function closeNoDisceptDialog() {\n    setNoDisceptDialogShown(false);\n  }\n\n  function addLanguage() {\n    closeNoDisceptDialog();\n    data.addFileDocumentPerLanguage(addingLanguage, file);\n    onChange();\n  }\n\n  return (\n    <>\n      <Dialog\n        open={loadCompletedDialogShown}\n        onClose={closeLoadCompletedDialog}\n        aria-labelledby=\"loadCompleted-dialog\"\n        aria-describedby=\"loadCompleted-dialog-desc\"\n      >\n        <DialogTitle id=\"loadCompleted-dialog\">{\"Data imported!\"}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"loadCompleted-dialog-desc\">\n            The file has been correctly imported!\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeLoadCompletedDialog}>OK</Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog\n        open={overwriteDialogShown}\n        onClose={closeOverwriteDialog}\n        aria-labelledby=\"overwrite-dialog\"\n        aria-describedby=\"overwrite-dialog-desc\"\n      >\n        <DialogTitle id=\"overwrite-dialog\">\n          {\"Changes will be overwritten!\"}\n        </DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"overwrite-dialog-desc\">\n            Please confirm you want to upload this new file and overwrite the\n            existing changes\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeOverwriteDialog}>Cancel</Button>\n          <Button onClick={overwriteFile} autoFocus>\n            Continue\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog\n        open={genericErrorDialogShown}\n        onClose={closeGenericErrorDialog}\n        aria-labelledby=\"generic-error-dialog\"\n        aria-describedby=\"generic-error-dialog-desc\"\n      >\n        <DialogTitle id=\"generic-error-dialog\">\n          {\"Something wrong happened!\"}\n        </DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"generic-error-dialog-desc\">\n            The uploaded file cannot be read correctly\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeGenericErrorDialog}>OK</Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog\n        open={noDisceptDialogShown}\n        onClose={closeNoDisceptDialog}\n        aria-labelledby=\"no-discept\"\n        aria-describedby=\"no-discept-desc\"\n      >\n        <DialogTitle id=\"no-discept\">{\"Valid TEI But...\"}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"no-discept-desc\">\n            The uploaded file does not look like a DiSCePT TEI model. Do you\n            want to import it as a language instead?\n          </DialogContentText>\n          <TextField\n            autoFocus\n            required\n            margin=\"dense\"\n            id=\"language\"\n            name=\"language\"\n            label=\"Language\"\n            type=\"text\"\n            fullWidth\n            variant=\"standard\"\n            onChange={(e) => setAddingLanguage(e.target.value)}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeNoDisceptDialog}>Cancel</Button>\n          <Button onClick={addLanguage} autoFocus>\n            Add\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}